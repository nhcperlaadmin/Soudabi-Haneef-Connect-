<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bengapadavu Ward 17 | Citizen Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600;700;800&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body { font-family: 'Manrope', sans-serif; -webkit-tap-highlight-color: transparent; }
        .glass { background: rgba(255, 255, 255, 0.85); backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px); }
        .section-fade { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .safe-bottom { padding-bottom: env(safe-area-inset-bottom); }
    </style>
</head>
<body class="bg-slate-50 text-slate-900">
    <div id="root"></div>

    <script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@18.2.0",
    "react-dom": "https://esm.sh/react-dom@18.2.0/client",
    "@google/genai": "https://esm.sh/@google/genai@1.34.0",
    "lucide-react": "https://esm.sh/lucide-react@^0.562.0",
    "react-router-dom": "https://esm.sh/react-router-dom@^7.11.0",
    "react/": "https://esm.sh/react@^19.2.3/"
  }
}
</script>

    <script type="module">
        import React, { useState, useEffect, useRef, useMemo } from 'react';
        import ReactDOM from 'react-dom';
        import { GoogleGenAI } from '@google/genai';

        // --- CONSTANTS & MOCK DATA ---
        const WARD_INFO = {
            name: "Bengapadavu (17)",
            panchayath: "Enmakaje Grama Panchayath",
            member: "Shri. Rajesh Kumar",
            phone: "+91 98470 12345",
            whatsapp: "919847012345"
        };

        const SCHEMES = [
            { id: 1, title: 'LIFE Mission Phase III', cat: 'Housing', desc: 'Housing for landless homeless families in Kerala.', eligibility: 'BPL families without land/house.' },
            { id: 2, title: 'MGNREGS Work Card', cat: 'Employment', desc: 'Guaranteed 100 days of manual work per year.', eligibility: 'Adults residing in the ward.' },
            { id: 3, title: 'Subhiksha Keralam', cat: 'Agriculture', desc: 'Subsidies for kitchen gardening and small scale farming.', eligibility: 'All residents with 1+ cent land.' },
            { id: 4, title: 'Kudumbashree Grants', cat: 'Social', desc: 'Micro-loans for women self-help groups.', eligibility: 'Registered NHG members.' }
        ];

        const EVENTS = [
            { id: 1, title: 'General Ward Sabha', date: '25', month: 'MAY', loc: 'Anganwadi Center 42', time: '03:00 PM' },
            { id: 2, title: 'Health Camp (Ayurveda)', date: '02', month: 'JUN', loc: 'School Hall', time: '09:00 AM' }
        ];

        // --- COMPONENTS ---

        const App = () => {
            const [activeTab, setActiveTab] = useState('home');
            const [isChatOpen, setIsChatOpen] = useState(false);

            useEffect(() => {
                if (window.lucide) window.lucide.createIcons();
            }, [activeTab, isChatOpen]);

            const renderContent = () => {
                switch(activeTab) {
                    case 'home': return React.createElement(HomeView, { setActiveTab });
                    case 'complaints': return React.createElement(ComplaintView);
                    case 'schemes': return React.createElement(SchemesView);
                    case 'events': return React.createElement(EventsView);
                    case 'contact': return React.createElement(ContactView);
                    default: return React.createElement(HomeView, { setActiveTab });
                }
            };

            return React.createElement('div', { className: 'min-h-screen lg:pl-72' },
                // Desktop Sidebar
                React.createElement('aside', { className: 'hidden lg:flex flex-col w-72 bg-emerald-950 text-white fixed h-full left-0 top-0 z-40' },
                    React.createElement('div', { className: 'p-8 border-b border-white/10' },
                        React.createElement('h1', { className: 'text-2xl font-black text-emerald-400' }, 'BENGAPADAVU'),
                        React.createElement('p', { className: 'text-emerald-100/50 text-[10px] font-bold uppercase tracking-widest mt-1' }, `Ward 17 • Enmakaje`)
                    ),
                    React.createElement('nav', { className: 'flex-1 p-6 space-y-2' },
                        ['home', 'complaints', 'schemes', 'events', 'contact'].map(tab => 
                            React.createElement('button', {
                                key: tab,
                                onClick: () => setActiveTab(tab),
                                className: `w-full flex items-center gap-4 px-5 py-4 rounded-2xl transition-all ${activeTab === tab ? 'bg-emerald-600 text-white shadow-lg shadow-emerald-900/40' : 'text-emerald-100/60 hover:bg-white/5 hover:text-white'}`
                            }, 
                                React.createElement('i', { 'data-lucide': tab === 'home' ? 'home' : tab === 'complaints' ? 'message-square' : tab === 'schemes' ? 'clipboard-list' : tab === 'events' ? 'calendar' : 'phone', className: 'w-5 h-5' }),
                                React.createElement('span', { className: 'font-bold capitalize' }, tab)
                            )
                        )
                    ),
                    React.createElement('div', { className: 'p-6' },
                        React.createElement('button', { 
                            onClick: () => setIsChatOpen(true),
                            className: 'w-full py-4 bg-white/10 border border-white/10 rounded-2xl text-sm font-bold hover:bg-white/20 transition-all flex items-center justify-center gap-2' 
                        }, React.createElement('i', { 'data-lucide': 'bot', className: 'w-4 h-4 text-emerald-400' }), 'Ward Mitra AI')
                    )
                ),

                // Mobile Header
                React.createElement('header', { className: 'lg:hidden sticky top-0 z-50 bg-emerald-950 text-white p-5 flex justify-between items-center' },
                    React.createElement('div', null,
                        React.createElement('h1', { className: 'font-black text-xl' }, 'Bengapadavu'),
                        React.createElement('p', { className: 'text-emerald-400 text-[10px] font-bold uppercase tracking-widest' }, 'Ward 17 Portal')
                    ),
                    React.createElement('button', { onClick: () => setIsChatOpen(true), className: 'bg-emerald-800 p-2.5 rounded-xl text-emerald-400' },
                        React.createElement('i', { 'data-lucide': 'bot' })
                    )
                ),

                // Main Content
                React.createElement('main', { className: 'p-6 lg:p-12 max-w-5xl mx-auto pb-32 lg:pb-12' }, renderContent()),

                // Mobile Bottom Nav
                React.createElement('nav', { className: 'lg:hidden fixed bottom-6 left-6 right-6 glass border border-white/40 shadow-2xl rounded-[2.5rem] flex justify-around p-3 z-50' },
                    ['home', 'complaints', 'schemes', 'events', 'contact'].map(tab => 
                        React.createElement('button', {
                            key: tab,
                            onClick: () => setActiveTab(tab),
                            className: `p-3 rounded-2xl transition-all ${activeTab === tab ? 'bg-emerald-600 text-white scale-110 shadow-lg' : 'text-slate-400'}`
                        }, React.createElement('i', { 'data-lucide': tab === 'home' ? 'home' : tab === 'complaints' ? 'message-square' : tab === 'schemes' ? 'clipboard-list' : tab === 'events' ? 'calendar' : 'phone', className: 'w-6 h-6' }))
                    )
                ),

                isChatOpen && React.createElement(ChatBot, { close: () => setIsChatOpen(false) })
            );
        };

        const HomeView = ({ setActiveTab }) => React.createElement('div', { className: 'space-y-10 section-fade' },
            React.createElement('div', { className: 'bg-emerald-900 rounded-[2.5rem] p-8 lg:p-14 text-white shadow-2xl relative overflow-hidden' },
                React.createElement('div', { className: 'relative z-10 max-w-2xl' },
                    React.createElement('span', { className: 'inline-block px-4 py-1.5 bg-emerald-800 text-emerald-300 rounded-full text-[10px] font-black uppercase tracking-widest mb-6' }, 'Ward Digital Hub'),
                    React.createElement('h2', { className: 'text-4xl lg:text-6xl font-black mb-6 leading-tight' }, 'Building a Better ', React.createElement('span', { className: 'text-emerald-400' }, 'Bengapadavu')),
                    React.createElement('p', { className: 'text-emerald-100/70 text-lg mb-8' }, 'Empowering Ward 17 residents with direct access to services and information.'),
                    React.createElement('div', { className: 'flex flex-wrap gap-4' },
                        React.createElement('button', { onClick: () => setActiveTab('complaints'), className: 'bg-white text-emerald-950 px-8 py-4 rounded-2xl font-black shadow-xl hover:scale-105 transition-all flex items-center gap-3' }, 
                            React.createElement('i', { 'data-lucide': 'plus-circle' }), 'Register Grievance'
                        )
                    )
                ),
                React.createElement('div', { className: 'absolute -bottom-24 -right-24 w-96 h-96 bg-emerald-800/20 rounded-full blur-3xl' })
            ),
            React.createElement('div', { className: 'grid grid-cols-2 lg:grid-cols-4 gap-4' },
                [
                    { l: 'Schemes', i: 'clipboard-list', c: 'emerald', t: 'schemes' },
                    { l: 'Events', i: 'calendar', c: 'blue', t: 'events' },
                    { l: 'Tracking', i: 'search', c: 'amber', t: 'complaints' },
                    { l: 'Contact', i: 'phone', c: 'purple', t: 'contact' }
                ].map(item => React.createElement('button', { 
                    key: item.l, 
                    onClick: () => setActiveTab(item.t),
                    className: 'bg-white p-6 rounded-[2rem] border border-slate-200/60 shadow-sm hover:shadow-xl transition-all group flex flex-col items-center gap-3 text-center' 
                },
                    React.createElement('div', { className: `w-14 h-14 bg-${item.c}-50 text-${item.c}-600 rounded-2xl flex items-center justify-center group-hover:bg-${item.c}-600 group-hover:text-white transition-all` }, React.createElement('i', { 'data-lucide': item.i })),
                    React.createElement('span', { className: 'font-extrabold text-slate-800 text-xs uppercase tracking-tight' }, item.l)
                ))
            )
        );

        const ComplaintView = () => {
            const [view, setView] = useState('menu');
            const [tickets, setTickets] = useState(() => JSON.parse(localStorage.getItem('ward17_tickets') || '[]'));
            const [formData, setFormData] = useState({ name: '', phone: '', desc: '' });
            const [searchId, setSearchId] = useState('');
            const [foundTicket, setFoundTicket] = useState(null);

            const submit = (e) => {
                e.preventDefault();
                const newT = { id: 'CMP' + Date.now().toString().slice(-6), ...formData, status: 'Submitted', date: new Date().toLocaleDateString() };
                const updated = [newT, ...tickets];
                setTickets(updated);
                localStorage.setItem('ward17_tickets', JSON.stringify(updated));
                alert(`Registered! Your ID: ${newT.id}`);
                setView('menu');
            };

            const track = () => {
                const t = tickets.find(t => t.id === searchId.toUpperCase());
                setFoundTicket(t || 'not_found');
            };

            return React.createElement('div', { className: 'section-fade space-y-8' },
                React.createElement('h2', { className: 'text-3xl font-black' }, 'Complaint Desk'),
                view === 'menu' && React.createElement('div', { className: 'grid md:grid-cols-2 gap-6' },
                    React.createElement('button', { onClick: () => setView('form'), className: 'bg-emerald-600 p-10 rounded-[2.5rem] text-white text-left shadow-xl hover:scale-[1.02] transition-all' },
                        React.createElement('i', { 'data-lucide': 'plus', className: 'w-12 h-12 mb-6' }),
                        React.createElement('h3', { className: 'text-2xl font-black' }, 'New Grievance'),
                        React.createElement('p', { className: 'opacity-70 mt-2' }, 'Report local issues to the member.')
                    ),
                    React.createElement('button', { onClick: () => setView('track'), className: 'bg-white p-10 rounded-[2.5rem] text-left border border-slate-200 shadow-xl hover:scale-[1.02] transition-all' },
                        React.createElement('i', { 'data-lucide': 'search', className: 'w-12 h-12 text-emerald-600 mb-6' }),
                        React.createElement('h3', { className: 'text-2xl font-black' }, 'Track Status'),
                        React.createElement('p', { className: 'text-slate-400 mt-2' }, 'Check progress with your ID.')
                    )
                ),
                view === 'form' && React.createElement('div', { className: 'bg-white p-8 rounded-[2.5rem] border border-slate-200' },
                    React.createElement('button', { onClick: () => setView('menu'), className: 'text-emerald-600 font-bold mb-6 flex items-center gap-2' }, React.createElement('i', { 'data-lucide': 'arrow-left' }), 'Back'),
                    React.createElement('form', { onSubmit: submit, className: 'space-y-6' },
                        React.createElement('input', { required: true, placeholder: 'Your Name', className: 'w-full p-4 bg-slate-50 rounded-xl border border-transparent focus:bg-white focus:border-emerald-500 outline-none transition-all', onChange: e => setFormData({...formData, name: e.target.value}) }),
                        React.createElement('input', { required: true, placeholder: 'Phone Number', className: 'w-full p-4 bg-slate-50 rounded-xl border border-transparent focus:bg-white focus:border-emerald-500 outline-none transition-all', onChange: e => setFormData({...formData, phone: e.target.value}) }),
                        React.createElement('textarea', { required: true, placeholder: 'Describe the issue...', rows: 4, className: 'w-full p-4 bg-slate-50 rounded-xl border border-transparent focus:bg-white focus:border-emerald-500 outline-none transition-all', onChange: e => setFormData({...formData, desc: e.target.value}) }),
                        React.createElement('button', { className: 'w-full bg-emerald-600 text-white font-bold py-4 rounded-xl' }, 'Submit Complaint')
                    )
                ),
                view === 'track' && React.createElement('div', { className: 'bg-white p-8 rounded-[2.5rem] border border-slate-200 text-center' },
                    React.createElement('button', { onClick: () => setView('menu'), className: 'text-emerald-600 font-bold mb-6 flex items-center gap-2' }, React.createElement('i', { 'data-lucide': 'arrow-left' }), 'Back'),
                    React.createElement('input', { placeholder: 'Enter ID (CMP...)', className: 'w-full p-4 bg-slate-50 rounded-xl mb-4 text-center font-bold tracking-widest', value: searchId, onChange: e => setSearchId(e.target.value) }),
                    React.createElement('button', { onClick: track, className: 'w-full bg-slate-900 text-white font-bold py-4 rounded-xl mb-6' }, 'Track Now'),
                    foundTicket === 'not_found' && React.createElement('p', { className: 'text-red-500 font-bold' }, 'No complaint found with this ID.'),
                    foundTicket && foundTicket !== 'not_found' && React.createElement('div', { className: 'text-left p-6 bg-emerald-50 rounded-2xl border border-emerald-100' },
                        React.createElement('p', { className: 'text-xs font-black text-emerald-600 uppercase' }, 'Status'),
                        React.createElement('h4', { className: 'text-xl font-black' }, foundTicket.status),
                        React.createElement('p', { className: 'text-sm text-slate-500 mt-2' }, foundTicket.desc)
                    )
                )
            );
        };

        const SchemesView = () => React.createElement('div', { className: 'section-fade space-y-6' },
            React.createElement('h2', { className: 'text-3xl font-black' }, 'Welfare Schemes'),
            React.createElement('div', { className: 'grid md:grid-cols-2 gap-6' },
                SCHEMES.map(s => React.createElement('div', { key: s.id, className: 'bg-white p-8 rounded-[2.5rem] border border-slate-200 shadow-sm' },
                    React.createElement('span', { className: 'text-[10px] font-black text-emerald-600 uppercase tracking-widest' }, s.cat),
                    React.createElement('h3', { className: 'text-xl font-black mt-2' }, s.title),
                    React.createElement('p', { className: 'text-sm text-slate-500 mt-3 leading-relaxed' }, s.desc),
                    React.createElement('div', { className: 'mt-6 p-4 bg-slate-50 rounded-xl' }, 
                        React.createElement('p', { className: 'text-[10px] font-bold text-slate-400 uppercase mb-1' }, 'Eligibility'),
                        React.createElement('p', { className: 'text-xs font-bold' }, s.eligibility)
                    )
                ))
            )
        );

        const EventsView = () => React.createElement('div', { className: 'section-fade space-y-6' },
            React.createElement('h2', { className: 'text-3xl font-black' }, 'Ward Calendar'),
            React.createElement('div', { className: 'space-y-4' },
                EVENTS.map(e => React.createElement('div', { key: e.id, className: 'bg-white p-6 rounded-[2rem] border border-slate-200 flex items-center gap-6' },
                    React.createElement('div', { className: 'text-center border-r border-slate-100 pr-6 shrink-0' },
                        React.createElement('p', { className: 'text-2xl font-black text-emerald-600 leading-none' }, e.date),
                        React.createElement('p', { className: 'text-[10px] font-bold uppercase text-slate-400' }, e.month)
                    ),
                    React.createElement('div', null,
                        React.createElement('h3', { className: 'font-black text-lg' }, e.title),
                        React.createElement('p', { className: 'text-xs text-slate-500 mt-1' }, `${e.loc} • ${e.time}`)
                    )
                ))
            )
        );

        const ContactView = () => React.createElement('div', { className: 'max-w-xl mx-auto space-y-8 section-fade' },
            React.createElement('h2', { className: 'text-3xl font-black text-center' }, 'Contact Member'),
            React.createElement('div', { className: 'bg-white p-10 rounded-[3rem] shadow-2xl border border-slate-200 space-y-6' },
                React.createElement('div', { className: 'text-center mb-8' },
                    React.createElement('div', { className: 'w-24 h-24 bg-emerald-100 rounded-full mx-auto mb-4 flex items-center justify-center text-emerald-600' }, React.createElement('i', { 'data-lucide': 'user', className: 'w-10 h-10' })),
                    React.createElement('h3', { className: 'text-2xl font-black' }, WARD_INFO.member),
                    React.createElement('p', { className: 'text-emerald-600 font-bold uppercase text-[10px] tracking-widest' }, 'Ward Member - Ward 17')
                ),
                React.createElement('div', { className: 'space-y-3' },
                    React.createElement('a', { href: `https://wa.me/${WARD_INFO.whatsapp}`, className: 'flex items-center gap-4 p-5 bg-emerald-50 text-emerald-700 rounded-3xl font-bold transition-all hover:bg-emerald-100' },
                        React.createElement('i', { 'data-lucide': 'message-circle' }), 'WhatsApp Message'
                    ),
                    React.createElement('a', { href: `tel:${WARD_INFO.phone}`, className: 'flex items-center gap-4 p-5 bg-slate-50 text-slate-700 rounded-3xl font-bold transition-all hover:bg-slate-100' },
                        React.createElement('i', { 'data-lucide': 'phone' }), 'Call Directly'
                    )
                )
            )
        );

        const ChatBot = ({ close }) => {
            const [input, setInput] = useState('');
            const [messages, setMessages] = useState([{ role: 'bot', text: 'Namaskaram! I am Ward Mitra. Ask me about LIFE Mission, MGNREGS, or ward meetings.' }]);
            const [loading, setLoading] = useState(false);

            const send = async () => {
                if (!input.trim()) return;
                const txt = input; setInput('');
                setMessages(prev => [...prev, { role: 'user', text: txt }]);
                setLoading(true);
                try {
                    const ai = new GoogleGenAI({ apiKey: window.process?.env?.API_KEY || '' });
                    const res = await ai.models.generateContent({
                        model: 'gemini-3-flash-preview',
                        contents: txt,
                        config: { systemInstruction: "Helpful AI for Ward 17 Bengapadavu, Kerala. Focus on welfare schemes and local governance." }
                    });
                    setMessages(prev => [...prev, { role: 'bot', text: res.text }]);
                } catch (e) {
                    setMessages(prev => [...prev, { role: 'bot', text: "Service temporarily unavailable. Please call the Ward Member directly." }]);
                }
                setLoading(false);
            };

            return React.createElement('div', { className: 'fixed inset-0 z-[100] bg-black/60 backdrop-blur-sm p-4 lg:p-10 flex flex-col' },
                React.createElement('div', { className: 'bg-white w-full max-w-2xl mx-auto rounded-[2.5rem] flex-1 flex flex-col overflow-hidden shadow-2xl' },
                    React.createElement('div', { className: 'p-6 bg-emerald-950 text-white flex justify-between items-center' },
                        React.createElement('div', null, React.createElement('h3', { className: 'font-black' }, 'Ward Mitra AI'), React.createElement('p', { className: 'text-[10px] text-emerald-400 font-bold uppercase' }, 'Resident Assistant')),
                        React.createElement('button', { onClick: close, className: 'p-2 hover:bg-white/10 rounded-full' }, React.createElement('i', { 'data-lucide': 'x' }))
                    ),
                    React.createElement('div', { className: 'flex-1 overflow-y-auto p-6 space-y-4 no-scrollbar' },
                        messages.map((m, i) => React.createElement('div', { key: i, className: `flex ${m.role === 'user' ? 'justify-end' : 'justify-start'}` },
                            React.createElement('div', { className: `max-w-[85%] p-4 rounded-3xl ${m.role === 'user' ? 'bg-emerald-600 text-white rounded-tr-none' : 'bg-slate-100 text-slate-800 rounded-tl-none'} text-sm font-medium` }, m.text)
                        )),
                        loading && React.createElement('div', { className: 'text-slate-400 text-xs italic' }, 'Ward Mitra is typing...')
                    ),
                    React.createElement('div', { className: 'p-6 bg-slate-50 border-t border-slate-100' },
                        React.createElement('div', { className: 'relative' },
                            React.createElement('input', { value: input, onChange: e => setInput(e.target.value), onKeyDown: e => e.key === 'Enter' && send(), placeholder: 'Type your question...', className: 'w-full py-4 px-6 pr-14 rounded-2xl bg-white border border-slate-200 outline-none focus:border-emerald-500 font-medium' }),
                            React.createElement('button', { onClick: send, className: 'absolute right-2 top-1/2 -translate-y-1/2 p-3 bg-emerald-600 text-white rounded-xl' }, React.createElement('i', { 'data-lucide': 'send', className: 'w-5 h-5' }))
                        )
                    )
                )
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(App));
    </script>
</body>
</html>